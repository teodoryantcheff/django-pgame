{% extends "base.html" %}
{% load i18n %}
{% load staticfiles %}

{% block help %}
  <strong>Sell coins</strong> <br/>
  Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquid atque cupiditate dolores ea earum eos et inventore minus placeat praesentium provident quam quod, rerum similique tenetur ut veniam vitae voluptate?
{% endblock %}

{% block content %}
  <h2>Sell coins for <b>{{ game_currency }}</b></h2>

  You have <b>{{ user.profile.balance_coins|floatformat:"1" }}</b> total coins right now. <br/>
  Rate <b>{{ coin_to_gc_rate }}</b> coins for one <b>{{ game_currency }}</b>

  <form action="" method="post">{% csrf_token %}
    {{ form.as_p }}
    <b style="color: red">{{ form.non_field_errors }}</b>
    <input type="submit" class="btn btn-lg btn-success" value="Sell for {{ game_currency }}" />
  </form>
  <br/><br/>
  {% if coin_conversion_history %}
    Last 10
    <table class="table table-hover table-condensed">
      <thead>
        <td><b>timestamp</b></td>
        <td><b>coins</b></td>
        <td><b>Inv {{ game_currency }}</b></td>
        <td><b>Wth {{ game_currency }}</b></td>
      </thead>
      {% for conversion in coin_conversion_history %}
        <tr>
          <td>{{ conversion.timestamp|date:"Y-m-d H:i" }}</td>
          <td class="numeric">{{ conversion.data.coins }}</td>
          <td class="numeric">{{ conversion.amount|floatformat:"3" }}</td>
          <td class="numeric">{{ conversion.data.withdrawal_gc|floatformat:"3"|default:"<i>missing</i>" }}</td>
        </tr>
      {% endfor %}
    </table>
  {% else %}
    <p>haven't converted any yet</p>
  {% endif %}


{% endblock %}